(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{3267:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return s(5589)}])},5589:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return p}});var t=s(5893),a=s(7294),i=s(3133),n=s(9368),d=s(8403),o=s(7278),l=s.n(o),c=s(1664),h=s.n(c),_=s(2091),m=s(1163);function p(){let{user:e}=(0,n.a)(),r=(0,m.useRouter)(),[s,o]=(0,a.useState)([]),[c,p]=(0,a.useState)(!0),[u,x]=(0,a.useState)(null),[j,g]=(0,a.useState)(null),[N,O]=(0,a.useState)(0),f=e=>{if(!e)return"N/A";let r=e.toDate();return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(r)};(0,a.useEffect)(()=>{async function r(){if(!e){p(!1);return}try{p(!0),x(null),await new Promise(e=>setTimeout(e,500));let r=await (0,d.uI)(e.id);console.log("Fetched orders:",r),o(r)}catch(e){console.error("Error fetching orders:",e),x("Failed to load your orders. Please try again."),N<1&&(O(e=>e+1),setTimeout(()=>r(),1500))}finally{p(!1)}}r()},[e,N]);let v=e=>{switch(e){case"delivered":return l().delivered;case"shipped":return l().shipped;case"processing":return l().processing;case"cancelled":return l().cancelled;default:return l().pending}};return e?(0,t.jsx)(i.Z,{title:"My Orders",children:(0,t.jsxs)("div",{className:l().ordersContainer,children:[(0,t.jsx)("h1",{className:l().title,children:"My Orders"}),c?(0,t.jsxs)("div",{className:l().loadingContainer,children:[(0,t.jsx)(_.fCD,{className:l().spinner}),(0,t.jsx)("p",{children:"Loading your orders..."})]}):u?(0,t.jsxs)("div",{className:l().errorContainer,children:[(0,t.jsx)("p",{className:l().errorMessage,children:u}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:l().retryButton,children:"Try Again"})]}):0===s.length?(0,t.jsxs)("div",{className:l().emptyStateContainer,children:[(0,t.jsx)("div",{className:l().emptyStateIcon,children:(0,t.jsx)(_.Xfy,{size:48})}),(0,t.jsx)("h2",{children:"You haven't placed any orders yet"}),(0,t.jsx)("p",{children:"Browse our products and place your first order!"}),(0,t.jsx)(h(),{href:"/",className:l().shopNowButton,children:"Shop Now"})]}):(0,t.jsx)(t.Fragment,{children:j?(0,t.jsxs)("div",{className:l().orderDetails,children:[(0,t.jsxs)("div",{className:l().orderDetailsHeader,children:[(0,t.jsx)("button",{className:l().backButton,onClick:()=>g(null),children:"Back to All Orders"}),(0,t.jsx)("h2",{children:"Order Details"}),(0,t.jsxs)("p",{className:l().orderId,children:["Order #",j.id]})]}),(0,t.jsxs)("div",{className:l().orderInfo,children:[(0,t.jsxs)("div",{className:l().orderInfoItem,children:[(0,t.jsx)("span",{className:l().label,children:"Date:"}),(0,t.jsx)("span",{children:f(j.createdAt)})]}),(0,t.jsxs)("div",{className:l().orderInfoItem,children:[(0,t.jsx)("span",{className:l().label,children:"Status:"}),(0,t.jsx)("span",{className:"".concat(l().statusBadge," ").concat(v(j.status)),children:j.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:l().orderInfoItem,children:[(0,t.jsx)("span",{className:l().label,children:"Total:"}),(0,t.jsxs)("span",{className:l().totalAmount,children:["₹",j.totalAmount.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:l().section,children:[(0,t.jsx)("h3",{children:"Shipping Details"}),(0,t.jsxs)("div",{className:l().shippingInfo,children:[(0,t.jsx)("p",{children:(0,t.jsxs)("strong",{children:[j.shipping.firstName," ",j.shipping.lastName]})}),(0,t.jsx)("p",{children:j.shipping.address}),(0,t.jsxs)("p",{children:[j.shipping.city,", ",j.shipping.state," ",j.shipping.zipCode]}),(0,t.jsx)("p",{children:j.shipping.country}),(0,t.jsxs)("p",{children:["Phone: ",j.shipping.phone||"N/A"]}),(0,t.jsxs)("p",{children:["Email: ",j.shipping.email]})]})]}),(0,t.jsxs)("div",{className:l().section,children:[(0,t.jsx)("h3",{children:"Items"}),(0,t.jsx)("div",{className:l().orderItems,children:j.items.map((e,r)=>(0,t.jsxs)("div",{className:l().orderItem,children:[(0,t.jsx)("div",{className:l().productImage,children:e.image&&(0,t.jsx)("img",{src:e.image,alt:e.name})}),(0,t.jsxs)("div",{className:l().productDetails,children:[(0,t.jsx)("h4",{children:e.name}),(0,t.jsxs)("p",{className:l().productMeta,children:["Size: ",e.size," | Qty: ",e.quantity]}),(0,t.jsxs)("p",{className:l().productPrice,children:["₹",e.price.toFixed(2)]})]})]},r))})]}),(0,t.jsxs)("div",{className:l().orderSummary,children:[(0,t.jsxs)("div",{className:l().summaryRow,children:[(0,t.jsx)("span",{children:"Subtotal:"}),(0,t.jsxs)("span",{children:["₹",(.9*j.totalAmount).toFixed(2)]})]}),(0,t.jsxs)("div",{className:l().summaryRow,children:[(0,t.jsx)("span",{children:"Tax (10%):"}),(0,t.jsxs)("span",{children:["₹",(.1*j.totalAmount).toFixed(2)]})]}),(0,t.jsxs)("div",{className:l().summaryRow,children:[(0,t.jsx)("span",{children:"Shipping:"}),(0,t.jsx)("span",{children:"Free"})]}),(0,t.jsxs)("div",{className:"".concat(l().summaryRow," ").concat(l().total),children:[(0,t.jsx)("span",{children:"Total:"}),(0,t.jsxs)("span",{children:["₹",j.totalAmount.toFixed(2)]})]})]})]}):(0,t.jsxs)("div",{className:l().ordersList,children:[(0,t.jsxs)("p",{className:l().orderCount,children:["Showing ",s.length," order",1!==s.length?"s":""]}),s.map(e=>(0,t.jsxs)("div",{className:l().orderCard,onClick:()=>g(e),children:[(0,t.jsxs)("div",{className:l().orderHeader,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:l().orderLabel,children:"Order #:"}),(0,t.jsx)("span",{className:l().orderId,children:e.id})]}),(0,t.jsx)("div",{className:"".concat(l().statusBadge," ").concat(v(e.status)),children:e.status.toUpperCase()})]}),(0,t.jsxs)("div",{className:l().orderContent,children:[(0,t.jsxs)("div",{className:l().orderInfo,children:[(0,t.jsxs)("div",{className:l().infoRow,children:[(0,t.jsx)("span",{className:l().infoLabel,children:"Date:"}),(0,t.jsx)("span",{children:f(e.createdAt)})]}),(0,t.jsxs)("div",{className:l().infoRow,children:[(0,t.jsx)("span",{className:l().infoLabel,children:"Items:"}),(0,t.jsxs)("span",{children:[e.items.length," item",1!==e.items.length?"s":""]})]}),(0,t.jsxs)("div",{className:l().infoRow,children:[(0,t.jsx)("span",{className:l().infoLabel,children:"Total:"}),(0,t.jsxs)("span",{className:l().orderTotal,children:["₹",e.totalAmount.toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:l().previewItems,children:[e.items.slice(0,3).map((e,r)=>(0,t.jsx)("div",{className:l().previewItem,children:e.image&&(0,t.jsx)("img",{src:e.image,alt:e.name,className:l().previewImage})},r)),e.items.length>3&&(0,t.jsxs)("div",{className:l().moreItems,children:["+",e.items.length-3]})]})]}),(0,t.jsxs)("div",{className:l().viewDetails,children:[(0,t.jsx)("span",{children:"View Details"}),(0,t.jsx)(_.H_v,{})]})]},e.id))]})})]})}):(0,t.jsx)(i.Z,{title:"My Orders",children:(0,t.jsx)("div",{className:l().ordersContainer,children:(0,t.jsxs)("div",{className:l().loginMessage,children:[(0,t.jsx)("h2",{children:"Please Login"}),(0,t.jsx)("p",{children:"You need to be logged in to view your orders."}),(0,t.jsx)("button",{onClick:()=>r.push("/login"),className:l().loginButton,children:"Go to Login"})]})})})}},8403:function(e,r,s){"use strict";s.d(r,{TR:function(){return i},Tl:function(){return o},uI:function(){return n},zk:function(){return d}});var t=s(3247),a=s(2531);let i=async e=>{try{if(!a.db)throw Error("Firestore is not initialized");let r=(0,t.hJ)(a.db,"orders"),s=t.EK.now(),i={...e,createdAt:s,updatedAt:s};return(await (0,t.ET)(r,i)).id}catch(e){throw console.error("Error saving order:",e),e}},n=async e=>{try{if(!a.db)throw Error("Firestore is not initialized");let r=(0,t.hJ)(a.db,"orders"),s=(0,t.IO)(r,(0,t.ar)("userId","==",e),(0,t.Xo)("createdAt","desc")),i=await (0,t.PL)(s),n=[];return i.forEach(e=>{let r=e.data();n.push({id:e.id,...r})}),n}catch(e){throw console.error("Error getting user orders:",e),e}},d=async function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"createdAt",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"desc",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,d=arguments.length>5?arguments[5]:void 0;try{let o;if(!a.db)throw Error("Firestore is not initialized");let l=(0,t.hJ)(a.db,"orders"),c=(0,t.IO)(l,(0,t.Xo)(s,i));if(e){let r=t.EK.fromDate(e);c=(0,t.IO)(c,(0,t.ar)("createdAt",">=",r))}if(r){let e=t.EK.fromDate(r);c=(0,t.IO)(c,(0,t.ar)("createdAt","<=",e))}c=(0,t.IO)(c,(0,t.b9)(n)),d&&(c=(0,t.IO)(c,(0,t.e0)(d)));let h=await (0,t.PL)(c),_=[];return h.forEach(e=>{let r=e.data();_.push({id:e.id,...r}),o=e}),{orders:_,lastDoc:o}}catch(e){throw console.error("Error getting all orders:",e),e}},o=async()=>{try{if(!a.db)throw Error("Firestore is not initialized");let e=(0,t.hJ)(a.db,"orders"),r=new Date;r.setMonth(r.getMonth()-1);let s=(0,t.IO)(e,(0,t.ar)("createdAt",">=",t.EK.fromDate(r)),(0,t.Xo)("createdAt","desc")),i=await (0,t.PL)(s),n=[];return i.forEach(e=>{let r=e.data();n.push({id:e.id,...r})}),n}catch(e){throw console.error("Error getting last month orders:",e),e}}},7278:function(e){e.exports={ordersContainer:"Orders_ordersContainer__3m3l3",title:"Orders_title__7wQVi",loadingContainer:"Orders_loadingContainer__a_jND",spinner:"Orders_spinner__y9rgo",spin:"Orders_spin__i57hV",emptyStateContainer:"Orders_emptyStateContainer__zRNe9",emptyStateIcon:"Orders_emptyStateIcon__l3gO6",shopNowButton:"Orders_shopNowButton__U0pHe",errorContainer:"Orders_errorContainer__PvxoL",errorMessage:"Orders_errorMessage__qJ2Dt",retryButton:"Orders_retryButton__B2hKE",loginMessage:"Orders_loginMessage__zTW__",loginButton:"Orders_loginButton__8rmEg",ordersList:"Orders_ordersList__R_6vY",orderCount:"Orders_orderCount__G7txG",orderCard:"Orders_orderCard__ychuc",orderHeader:"Orders_orderHeader__7g2oh",orderLabel:"Orders_orderLabel__uxy_O",orderId:"Orders_orderId__bwYK9",statusBadge:"Orders_statusBadge__Imqia",pending:"Orders_pending__7K5HX",processing:"Orders_processing__OJ0D9",shipped:"Orders_shipped__JBvkp",delivered:"Orders_delivered__raU9Q",cancelled:"Orders_cancelled__YOYFp",orderContent:"Orders_orderContent__DlCXr",orderInfo:"Orders_orderInfo__n69sP",infoRow:"Orders_infoRow__1JkfL",infoLabel:"Orders_infoLabel__7fy4V",orderTotal:"Orders_orderTotal__FlFS_",previewItems:"Orders_previewItems__vz9Vv",previewItem:"Orders_previewItem__38Y_o",moreItems:"Orders_moreItems__tQcgO",viewDetails:"Orders_viewDetails__GSdca",orderDetails:"Orders_orderDetails__L82OV",orderDetailsHeader:"Orders_orderDetailsHeader__I_yPX",backButton:"Orders_backButton__VqSci",orderInfoItem:"Orders_orderInfoItem__gPz8r",label:"Orders_label__HqT5L",totalAmount:"Orders_totalAmount__R7cUq",section:"Orders_section__jKhPI",shippingInfo:"Orders_shippingInfo__4MW60",orderItems:"Orders_orderItems__goHD0",orderItem:"Orders_orderItem__Ur_6x",productImage:"Orders_productImage__xJp7P",productDetails:"Orders_productDetails__RHDCO",productMeta:"Orders_productMeta__g4nZO",productPrice:"Orders_productPrice__jgCc3",orderSummary:"Orders_orderSummary__U_3wJ",summaryRow:"Orders_summaryRow__Kpxif",total:"Orders_total__SLUFL"}},9008:function(e,r,s){e.exports=s(6665)}},function(e){e.O(0,[365,913,133,888,774,179],function(){return e(e.s=3267)}),_N_E=e.O()}]);